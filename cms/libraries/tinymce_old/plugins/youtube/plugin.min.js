/**
 * plugin.js
 *
 * Copyright, VMLab.IT
 * Released under GPL License.
 *
 */

/**
 * youtube_alpha plugin that adds a toolbar button for adding youtube video.
 */
tinymce.PluginManager.add('youtube', function(editor, url) {
	// Add a button that opens a window
	editor.addButton('youtube', {
		text: 'YouTube',
		icon: false,
		onclick: function() {
			// Open window
			editor.windowManager.open({
				title: 'YouTube plugin',
				body: [
					{type: 'textbox', name: 'code', label: 'Video code'},
					{type: 'textbox', name: 'width', label: 'Width'}
				],
				onsubmit: function(e) {
					// Insert content when the window form is submitted
					var width = 0;
					if (e.data.width >= 200 && e.data.width <= 978) {
						width = e.data.width;
					}
					if(e.data.code && width)
						editor.insertContent('<iframe width="'+e.data.width+'" height="'+e.data.width/1.6+'" src="http://www.youtube.com/embed/'+e.data.code+'" frameborder="0" allowfullscreen></iframe>');
					else
						tinyMCE.activeEditor.windowManager.alert('Code field required, pixel width between 200 and 978.');
						
				}
			});
		}
	});


	// Adds a menu item to the tools menu
	editor.addMenuItem('youtube', {
		text: 'YouTube plugin',
		context: 'tools',
		onclick: function() {
			// Open window
			editor.windowManager.open({
				title: 'YouTube plugin',
				body: [
					{type: 'textbox', name: 'code', label: 'Video code'},
					{type: 'textbox', name: 'width', label: 'Width'}
				],
				onsubmit: function(e) {
					// Insert content when the window form is submitted
					var width = 0;
					if (e.data.width >= 200 && e.data.width <= 978) {
						width = e.data.width;
					}
					if(e.data.code && width)
						editor.insertContent('<iframe width="'+e.data.width+'" height="'+width/1.6+'" src="http://www.youtube.com/embed/'+e.data.code+'" frameborder="0" allowfullscreen></iframe>');
					else
						tinyMCE.activeEditor.windowManager.alert('Code field required, pixel width between 200 and 978.');
						
				}
			});
		}
	});
});